{
  "from": "events",
  "select": [
    "country", 
    {"COUNT": "*", "as": "total_events"},
    {"SUM": "total_price", "as": "total_revenue"}, 
    {"AVG": "total_price", "as": "avg_price"},
    {"MIN": "total_price", "as": "min_price"},
    {"MAX": "total_price", "as": "max_price"}
  ],
  "where": [
    {"col": "type", "op": "eq", "val": "purchase"}
  ],
  "group_by": ["country"],
  "order_by": [{"col": "total_revenue", "dir": "desc"}],
  "limit": 10
}