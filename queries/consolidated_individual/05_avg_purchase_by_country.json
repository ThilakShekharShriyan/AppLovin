{
  "from": "events",
  "select": [
    "country",
    {
      "AVG": "total_price",
      "as": "avg_purchase_value"
    },
    {
      "COUNT": "*",
      "as": "purchase_count"
    }
  ],
  "where": [
    {
      "col": "type",
      "op": "eq",
      "val": "purchase"
    }
  ],
  "group_by": [
    "country"
  ],
  "order_by": [
    {
      "col": "avg_purchase_value",
      "dir": "desc"
    }
  ],
  "limit": 25
}